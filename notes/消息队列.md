##### JMS基本功能

```
1、JMS 消息传递域:
    a、 点对点(point-to- point)消息传递域
    b、 发布/订阅(publish/subscribe) 消息传递域 
2、p2p：
    a、 每个消息只能有一个消费者
    b、 生产者和消费者没有时间上的相关性，无论消费者在生产者发送消息时是否处于运行状态，都可以收到消息
3、pub/sub发布订阅：
    a、每个消息可以有多个消费者
    b、但是消费者和生产者之间有时间相关性，消费者只能接收到订阅之后发布的消息
    注：JMS规范允许创建持久订阅,持久订阅允许消费者消费它在未处于激活状态时发送的消息
    queue和topic的区别
4、消息：
    a、消息头：识别信息和路由信息，如消息发送的目的地、传送模式(持久模式和非持久模式)、消息优先级(10级,默认级别是4)、唯一识别每个消息的标识
    b、消息体：需要传递的消息内容，五种消息格式(text\map\bytes\stream\object)
    c、属性：设置的属性，标准属性和消息中间件 定义的属性
```

###### 持久订阅

```
1、持久订阅者和非持久订阅者针对的Domain是Pub/Sub，而不是P2P
2、当 Broker 发送消息给订阅者时，如果订阅者处于未激活状态状态:持久订阅者可以收到消息，而非持久订阅者则收不到消息。
注：持久订阅者处于 未激活(已注册) 状态时，Broker需要为持久订阅者保存消息;如果持久订阅者订阅的消息太多则会溢出。
```
##### JMS 的事务性会话和非事务性会话

```
1、JMS Session 接口提供了 commit 和 rollback 方法。
2、事务提交意味着生产的所有消息被发送，消费的所有消息被确认;
3、事务回滚意味着生产的所有消息被销毁，消费的所有消息被恢复并重新提交，除非它们已经过期。
4、事务性的会话总是牵涉到事务处理中，commit 或 rollback 方法一旦被调用，一个事务就结束了，而另一个事务被开始。关闭事务性会话将回滚其中的事务
```
##### 消息的确认

```
事务会话
    a、生产者：消息的确认是自动进行，session.commit()以后，消息会自动确认
    b、必须保证发送端和接收端都是事务性会话 TODO
非事务会话 确认取决于创建会话时的应答模式
    a、Session.AUTO_ACKNOWLEDGE：receive 方法返回 或MessageListenner.onMessage方法返回时自动确认
    b、Session.CLIENT_ACKNOWLEDGE：调用消息的 acknowledge 方法确认消息(此确认是在会话层上进行，确认一个被消费的消息将自动确认所有已被会话消费的消息，例如一个消费者消费了10个消息，然后确认了第5个消息，那么 0~5 的消息都会被确认)
    c、Session.DUPS_ACKNOWLEDGE：消息延迟确认，这种模式不在乎接受者收到重复的消息。
    
```
##### 消息的持久化存储

```
非持久：消息驻留在内存中，provider宕机，那么内存中的非持久消息会丢失
持久消息：先将消息存储到稳定介质中，等消息发送成功后再删除
```




